
@{
    ViewBag.Title = "Registreerimine";
}

<h2>Registreerimine</h2>

<div class="container">
    <div class="row">
        <form id="register">
            <div class="form-group">
                <label for="exampleInputEmail1">Email</label>
                <input type="text" class="form-control" id="email" aria-describedby="emailHelp" placeholder="Teie email" required>
            </div>

            <div class="form-group">
                <label for="exampleInputPassword1">Salasõna</label>
                <input type="password" class="form-control" id="password" placeholder="Teie salasõna" required>
            </div>

            <div class="form-group">
                <label for="exampleInputPassword1">Korda salasõna</label>
                <input type="password" class="form-control" id="password_second" placeholder="Teie salasõna" required>
            </div>

            <div class="form-group">
                <label for="exampleInputName">Nimi</label>
                <input type="text" class="form-control" id="name" placeholder="Teie nimi" required>
            </div>

            <button type="submit" class="btn btn-primary">Regitreeri</button>
            <hr />
            <p>Juba olete registreerinud? <a href="../../Home/Login">Logi Sisse</a>.</p>
            <div id="alert-error"></div>
        </form>
    </div>
</div>
<script>
    $(document).ready(function () {
    $('#register').submit(function (e) {
        e.preventDefault();
        const email = $('#email').val();
        const password = $('#password').val();
        const password_second = $('#password_second').val();
        const name = $('#name').val();
        const data = {
            'email': email,
            'password': password,
            'password_second': password_second,
            'name': name
        };

        $.ajax({
            method: "post",
            url: "../../api/user",
            contentType: "application/json",
            dataType: "json",
            data: JSON.stringify(data)
        }).done(function (data) {
            if (data.ResultCode == 200) {
                window.location.href = "../../Home/Success";
            } else {
                $('#alert-error').html(`
                    <div class="alert alert-danger alert-dismissible fade show" role="alert">
                        <h5><i class="fa fa-exclamation-triangle" aria-hidden="true"></i> Ошибка</h5>
                        ${data.ResultMessage}
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                `);
            }
        });
    })
  })
</script>